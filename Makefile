NAME    = push_swap
CC      = cc
CFLAGS  = -Wall -Wextra -Werror -g -I. -I$(INC_DIR)

SRC_DIR = src
INC_DIR = inc
LIBFT_DIR = 42_Libft
LIBFT = $(LIBFT_DIR)/libft.a
MOVES_DIR = $(SRC_DIR)/moves
PARSING_DIR = $(SRC_DIR)/parsing
UTILS_DIR = $(SRC_DIR)/utils
SORT_DIR = $(SRC_DIR)/sort

SRC = $(SRC_DIR)/main.c \
	$(PARSING_DIR)/parsing.c \
	$(PARSING_DIR)/valid_and_init.c \
	$(PARSING_DIR)/give_index.c \
	$(MOVES_DIR)/swap.c \
	$(MOVES_DIR)/push.c \
	$(MOVES_DIR)/rotate.c \
	$(MOVES_DIR)/rev_rotate.c \
	$(UTILS_DIR)/utils_movements.c \
	$(UTILS_DIR)/utils.c \
	$(UTILS_DIR)/frees.c \
	$(SRC_DIR)/error.c \
	$(SORT_DIR)/sort.c \
	$(SORT_DIR)/split_into_chunks.c \
	$(SORT_DIR)/small_sorts.c \

ARGV_INT = -138 115 -179 -45 121 -150 -143 122 37 96 25 164 149 4 -29 -115 -113 109 66 -244 15 231 -31 43 167 88 -30 -79 42 -26 29 228 192 -162 -112 -176 57 -175 -213 161 -152 -151 128 209 -127 -91 69 -225 87 -47 208 -9 -84 -228 -18 -83 157 195 -214 81 162 63 -12 -220 113 59 75 -201 82 244 -124 190 3 -1 -120 48 218 -216 24 -184 -187 -199 238 237 -74 -156 -92 -105 174 224 168 -36 -46 -159 27 35 -102 93 -210 175 62 -78 106 -25 -119 -35 -164 55 30 210 -82 -193 -95 -32 64 -64 -248 -161 225 160 193 -207 -133 90 -93 -154 1 242 117 -34 -94 105 -183 65 -177 -196 -48 -111 -180 -171 216 46 -59 -41 49 -37 199 70 -130 -57 -131 150 249 123 -134 86 -241 -39 232 -58 -185 -7 178 21 211 -8 -246 -20 -188 -233 125 -136 72 114 45 245 184 -239 -4 -126 -206 -212 188 61 223 154 185 146 -189 -194 -101 182 -71 -10 -178 -66 36 163 104 -242 92 -227 41 -104 -219 28 -97 58 8 220 173 -73 -223 -203 -38 -166 -23 222 -17 235 94 -60 38 -147 -122 67 -218 103 18 -204 79 -135 19 -19 -238 12 9 180 -2 5 50 221 206 -72 186 130 118 -215 76 -81 177 -158 102 11 -51 183 -100 -146 84 189 -106 60 -173 6 47 -142 0 212 133 -182 77 -16 99 -103 -15 207 236 33 229 234 140 -198 7 -5 169 -139 -13 -67 137 -229 138 194 -209 83 31 56 80 -236 -88 -107 73 153 -6 -170 -128 32 22 107 176 116 -33 -11 -53 -169 144 100 155 127 233 -129 -217 -200 -28 120 219 101 196 -202 -63 -132 243 159 205 -69 214 -208 129 74 98 -125 -42 131 -226 -140 -85 135 147 230 -247 -174 -168 124 143 136 -90 -167 16 240 -3 -197 -235 158 -118 14 -110 23 170 179 10 152 -157 52 141 -89 151 -145 197 -123 -21 71 -87 -192 -237 201 40 -116 -245 44 142 -231 -62 227 203 -114 -76 54 51 -61 -75 246 134 172 -155 226 -77 -153 13 -160 97 -149 171 85 68 34 20 126 -121 119 239 26 200 198 -65 78 -234 -86 247 112 -137 -240 -232 -27 215 89 -96 -221 108 -165 181 -68 204 -40 -190 -43 -243 187 -249 -181 -195 -109 -148 -24 217 2 -108 -56 -186 39 -141 -14 -50 110 -22 -49 145 213 -224 -117 -98 -55 156 165 248 -222 139 -70 91 -99 -172 -52 -230 166 -144 -211 -80 202 -44 -250 -54 148 132 -163 191 111 -205 95 -191 17 53 241 
# ARGV_INT = 2 1 0
# ARGV_INT = 10 15 2 9 6 3 4
# ARGV_INT = 100   14   19   28   54   23   43   79   33   80   49   20   89   17   6   64   3   13   98   84   27   78   39   63   60   10   83   25   16   38   40   50   8   21   62   55   4   88   87   12   75   9   46   86   94   45   18   65   52   32   36   53   95   7   67   34   82   11   47   42   74   92   71   48   2   91   70   59   41   1   69   77   5   44   29   85   68   37   31   26   99   72   93   58   97   35   61   24   81   90   76   22
ARGV_STR = "+32 10 -12 -32 +12 -8412 -432 143 134"

all: $(LIBFT) $(NAME)

$(LIBFT_DIR):
	git clone git@github.com:m3irel3s/42_Libft.git $(LIBFT_DIR)
	$(MAKE) -C $(LIBFT_DIR)

$(LIBFT): $(LIBFT_DIR)
	$(MAKE) -C $(LIBFT_DIR)

$(NAME): $(SRC)
	$(CC) $(CFLAGS) -o $(NAME) $(SRC) $(LIBFT)

clean:
	rm -f $(NAME)

# gdb: $(NAME) $(SRC)
# 	gdb ./$(NAME) -tui

gdb: all $(NAME) ## Debug w/ gdb
	tmux split-window -h "gdb --tui --args --log-file=gdb.txt ./$(NAME)"
	tmux resize-pane -L 5
	make get_log

get_log:
	rm -f gdb.txt
	touch gdb.txt
	@if command -v lnav; then \
		lnav gdb.txt; \
	else \
		tail -f gdb.txt; \
	fi

test_str: $(NAME) $(SRC)
	./$(NAME) $(ARGV_STR)

test_int: $(NAME) $(SRC)
	./$(NAME) $(ARGV_INT)

fclean: clean
	rm -f $(NAME)
	rm -rf $(LIBFT_DIR)

re: fclean all

.PHONY: all clean fclean re
